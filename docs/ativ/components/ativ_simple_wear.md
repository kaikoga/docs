---
sidebar_position: 1
---

# ATiV Simple Wear

:::note[NOTE]
このコンポーネントは `ndmf:NDMF` または `ablet:Ablet` を通してのみ機能します。
:::

衣装アセットをアバターに着せます。
または、アバターアイテムアセットをアバターに装着します。

:::warning[WARNING]
このコンポーネントはベータ版です。

アバターへのドラッグアンドドロップのみで自動で装着するには機能が不足していることが予想されます。
また、バージョンアップの際に再設定が必要になったり、適用時の挙動が変化する（今まで着せられていた設定では着せられなくなる）ことが予想されています。
:::

:::danger[DANGER]
しないとは思いますが、配布アセットには使用しないでください。
:::

このコンポーネントはボーンの統合は行いません。
単に衣装アセットのボーンがアバター素体のボーンに対して入れ子になります。

:::tip[TIPS]
`ativ:AtivSimpleWear` 以外の最適化プラグインが入れ子ボーンを自動的に結合することがあります。
:::

## 役に立つ状況

`ma:ModularAvatarMergeArmature` や `ma:ModularAvatarBoneProxy` 、 `vrcf:ArmatureLink` をある程度置き換えます。

VRChat想定衣装アセットを非VRChatプロジェクトで扱う際に便利です。

## 使い方

### 衣装アセットのセットアップ

衣装アセットを右クリックして、 `Avatar Tinker Vista` → `Simple Wear Setup as Humanoid Module` を実行します。

:::tip[TIPS]
自動セットアップの際、 `Module Ignore Bones` に衣装アセットの揺れもののルートがセットされます。

揺れものに対して装着されるタイプの衣装アセットでは、 `Module Ignore Bones` の指定を手動で外す必要があるかもしれません。
:::

### アバターアイテムアセットのセットアップ

衣装アセットを右クリックして、 `Avatar Tinker Vista` → `Simple Wear Setup as Accessory Module` を実行します。

`Module Root Bones` の `Human Bone` を調整します。

### アバターへの装着

衣装アセットまたはアバターアイテムアセットをアバター素体の子に移動した状態で `Setup Avatar` ボタンを押します。

:::note[NOTE]
押さなくても動くかもしれません。
:::

:::tip[TIPS]
自動セットアップの際、 `Avatar Ignore Bones` にアバター素体の揺れもののルートがセットされます。

揺れものに対して装着されるタイプの衣装アセットでは、 `Avatar Ignore Bones` の指定を手動で外す必要があるかもしれません。
:::

### 装着結果の調整

`ativ:AtivSimpleWear` は魔法のような自動検出を行いません。

インスペクタの `Show Mapping` からボーンの対応をプレビューした場合、

#### 衣装またはアバターのボーンを無視する

`ativ:AtivSimpleWear` はボーン名の完全一致を必要とせずに貪欲にボーンの統合対象を決定するため、無調整の場合は手の揺れものが指に統合されたり、頭のアクセサリーが Eye や Jaw に統合されたりします。

衣装アセットまたはアバターアセットのどちらかに統合可能なボーンが存在しない場合は統合されないので、適切に衣装アセットを装着する上では衣装アセットまたはアバターアセットのどちらかで装着対象のボーン構造を指定し、それ以外のボーンを対象から外すとよいです。

具体的には、以下のようにして装着処理の対象にしないボーンを無視してください。

- 衣装アセットの装着処理の対象にしたくないボーンを手動で `Module Ignore Bones` や `Module Leaf Bones` に追加する。
- アバターアセットの装着処理の対象にしたくないボーンを手動で `Avatar Ignore Bones` や `Avatar Leaf Bones` に追加する。
- アセットがヒューマノイドとしてインポートされているなら、 `Armature Mode` を `Humanoid` にする。（揺れものが無視されます）

#### ボーンの対応関係を明示する

現在、ボーン名が一致しない場合の対応付けは不安定です。

衣装とアバターのボーン名が一致しない場合、以下のいずれかを行ってください。

- 衣装アセットの `Armature Mode` が `Humanoid` で、ヒューマノイドボーンを統合したいの場合：
  - `Module Root Bones` と `Avatar Root Bones` の同じ位置に、マッチさせたいボーンを指定してください。
- 衣装アセットの `Armature Mode` が `All` の場合：
  - 衣装のボーンのオブジェクト名をアバターのボーンのオブジェクト名に一致させてください。

:::info[INFO]
正確には、アバター側のボーン名を衣装側が含んでいる場合、ボーン名が一致しているとみなされます。
:::

#### 衣装またはアバターのボーン位置を修正する

現在、衣装とアバターのポーズやスケールが異なっている場合に自動的に合わせる処理は未実装です。

手動で調整してください。

### 設定の詳細

#### `Module Settings`

衣装アセットまたはアバターアイテムアセット側の設定です。
（以下、モジュールと呼びます。）

- `Module Root Bones`: モジュール側の（アバターに移動する）ボーン階層のルートを指定します。
  - `Root Bone`: ボーンの参照です。
  - `Armature Mode`: 階層的マージの方法を選択します。
    - `None`: 階層的マージを行いません。
    - `Humanoid`: ヒューマノイドボーンを階層的にマージします。
    - `All`: 全てのボーンを階層的にマージします。
  - `Human Bone`:  `Setup Avatar` の際にセットされるヒューマノイドボーンを設定します。 
- `Module Ignore Bones`: ここに指定したボーンは装着処理の対象になりません。
- `Module Leaf Bones`: ここに指定したボーンの子は装着処理の対象になりません。

#### `Avatar Settings`

アバター素体アセット側の設定です。
（以下、単にアバターと呼びます。）

- `Avatar Root Bones`: アバター側の（モジュールから移動される）ボーン階層のルートを指定します。
  - `Armature Mode` は設定できますが、無視されます。
- `Avatar Ignore Bones`: ここに指定したボーンは装着処理の対象になりません。
- `Avatar Leaf Bones`: ここに指定したボーンの子は装着処理の対象になりません。
